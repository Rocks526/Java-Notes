# 一：微服务介绍

### 1.1 微服务架构的介绍

“微服务”一词来源于 Martin Flower 的名为 Microservices 的博文，简单来说，微服务是`系统架构上的一种设计风格`，它的主旨是`将一个原本独立的系统拆分成多个小型服务`，这些小型服务都在各自`独立的进程`中运行，服务之间通过`基于HTTP的RESTful API进行通信协作`。被拆分的每一个小型服务都`围绕着系统中的某一项或一些耦合度较高的业务功能`进行构建，并且每个服务都维护着自身的数据存储、业务开发、自动化测试案例以及独立部署机制。由于有了轻量级的通信协作基础，所以这些微服务可以`使用不同的语言编写`。

### 1.2 和单体系统的区别

在传统单体架构中，针对一个复杂的业务需求通常使用对象或业务类型来构建一个单体项目。在项目中通常分为三个主要部分：`数据库、服务端业务处理、前端展示`。在业务发展初期，由于所有业务逻辑在一个应用里，开发、测试、部署都比较方便，但随着业务不断发展，项目体量不断增长，单体应用会变得越来越臃肿。

- 优点
  - 开发简单、集中式管理
  - 基本不会重复开发
  - 功能都在本地，没有分布式管理和调用消耗
- 缺点
  - 效率低：开发都在同一个项目改代码，相互等待，冲突不断
  - 维护难：代码功功能耦合在一起，难以阅读
  - 不灵活：构建时间长，任何小修改都要重构整个项目，耗时
  - 稳定性差：一个微小的问题，都可能导致整个应用挂掉
  - 扩展性不够：在高并发场景下，无法针对单个业务逻辑调整资源分配

### 1.3 微服务特征

- 一些独立的服务共同组成系统
- 每个服务为独立的业务负责
- 强服务个体和弱通信（ Smart endpoints and dumb pipes ）
- 自动化运维（ DevOps ）
- 高度容错性
- 快速演化和迭代

# 二：SpringCloud介绍

### 2.1 SpringCloud介绍

Spring Cloud是一个基于Spring Boot实现的微服务架构开发工具，是一个微服务架构开发的一站式解决方案。里面包含了众多子项目，为微服务架构中涉及的配置管理、服务治理、断路器、智能路由、微代理、控制总线、全局锁、决策竞选、分布式会话和集群状态管理等操作提供了一种简单的开发方式。

### 2.2 SpringCloud子项目

Spring Cloud包含众多子项目，具体如下：

- `Spring Cloud Config`：配置管理工具，支持Git存储配置内容，可以使用它实现应用配置的外部化存储，支持客户端配置信息刷新、加密/解密配置内容等。
- `Spring Cloud Netflix`：核心组件，对多个Netflix OSS开源套件进行整合。
  - Eureka：服务治理组件，包含服务注册中心、服务注册与发现机制的实现。
  - Hystrix：容错管理组件，实现断路器模式，帮助服务依赖中出现的延迟和故障提供强大的容错能力。
  - Ribbon：客户端负载均衡的服务调用组件。
  - Feign：基于Ribbon和Hystrix的声明式服务调用组件。
  - Zuul：网关组件，提供智能路由、访问过滤等功能。
  - Archaius：外部化配置组件。
- `Spring Cloud Bus`：事件、消息总线，用于传播集群中状态变化或事件，以触发后续的处理，比如动态刷新配置等。
- Spring Cloud Consul：服务发现和配置管理组件。
- `Spring Cloud Stream`：通过Redis、RabbitMQ或Kafka实现的消费微服务，可以通过简单的声明式模型来发送和接收消息。
- Spring Cloud AWS：用于简化整合Amazon Web Service的组件。
- Spring Cloud Security：安全工具包，提供在Zuul代理中对OAuth2客户端请求的中继器。
- Spring Cloud Sleuth：Spring Cloud应用的分布式跟踪实现，可以整合Zipkin。
- Spring Cloud Zookeeper：基于Zookeeper的服务发现和配置管理组件。
- Spring Cloud Starter：Spring Cloud基础组件，它是基于Spring Boot风格项目的基础依赖模块。
- Spring Cloud CLI：用于在Groovy中快速创建Spring Cloud应用的Spring Boot CLI插件。
- .................

### 2.3 SpringCloud版本

由于Spring Cloud不像Spring社区其他一些项目那样相对独立，它是一个`拥有诸多子项目的大型综合项目`，可以说是对微服务架构解决方案的综合套件组合，其包含的各个子项目也都独立进行着内容的更新与迭代，各自都维护着自己的版本号。因此为了管理每个版本的子项目，避免Spring Cloud的版本号和子项目的版本号混淆，采用了命名的方式管理版本。

Spring Cloud的版本采用了伦敦地铁站的命名，根据字母顺序来对应版本时间顺序，比如最早的Release版本为Angel，第二个版本为Brixton，后续则是C到Z等。Spring Cloud发布的版本Angel.SR6，后面的SR6就是版本号了。

当一个版本的Spring Cloud项目的发布内容积累到临界点或修复一个严重的bug，就会发布一个"service release"版本，简称SRX版本，X是一个递增的数字。

### 2.4 Spring Cloud优劣

采用Spring Cloud开发微服务架构，相当于购买品牌方的整机，保证整个系统的稳定，提供强大的售后服务，而采用各种开源或自研组件相当于自己购买部件组装，有较高的灵活性，但也容易出现不兼容的问题。

因此，当研发能力较强时，可以考虑自行组装或自研，选择最契合业务的技术，当研发能力较弱时，可以采用Spring Cloud框架，避免出现奇奇怪怪的问题。