# 一：Java介绍

![image-20201222111721100](http://rocks526.top/lzx/image-20201222111721100.png)

`Java不仅仅是一门编程语言，还是一个由一系列计算机软件和规范形成的技术体系`，这个技术体系提供了完整的用于软件开发和跨平台部署的支持环境，并广泛应用于嵌入式系统、移动终端、企业服务器、大型机等各种场合。

Java能获得如此广泛的认可，除了它拥有一门结构严谨、面向对象的编程语言之外，还有许多不可忽视的优点：

- 通过Jvm实现平台硬件隔离，实现一次编译，到处运行
- 提供了一个相对安全的内存管理和访问机制，避免了绝大部分的内存泄露和指针越界问题
- 实现了热点代码检测和运行时编译及优化，这使得Java应用能随着运行时间的增加而获得更高的性能
- 有一套完善的应用程序接口，还有无数的第三方类库

# 二：Java技术体系

从广义上讲，Scala、Kotlin、Groovy等运行于Java虚拟机上的语言及其相关的程序都属于Java技术体系中的一员。

如果仅从传统意义上来看，Sun官方所定义的Java技术体系包括以下几个组成部分：

- Java程序设计语言
- 各种硬件平台上的Java虚拟机
- Class文件格式
- Java API类库
- 第三方Java类库

我们可以把`Java程序设计语言相关工具、Java虚拟机、Java API类库这三部分统称为JDK（Java Development Kit）`，JDK是用于支持Java程序开发的最小环境。可以把`Java API类库中的Java SE API子集和Java虚拟机这两部分统称为JRE（Java Runtime Environment）`，JRE是支持Java程序运行的标准环境。

![image-20201215113313807](http://rocks526.top/lzx/image-20201215113313807.png)

以上是根据各个组成部分的功能来进行划分的，如果按照技术所服务的领域来划分，Java技术体系可以分为4个平台，分别为：

- Java Card：支持一些Java小程序（Applets）运行在小内存设备（如智能卡）上的平台。
- Java ME（Micro Edition）：支持Java程序运行在移动终端（手机、PDA）上的平台，对Java API有所精简，并加入了针对移动终端的支持，这个版本以前称为J2ME。
- Java SE（Standard Edition）：支持面向桌面级应用（如Windows下的应用程序）的Java平台，提供了完整的Java核心API，这个版本以前称为J2SE。
- Java EE（Enterprise Edition）：支持使用多层架构的企业应用（如ERP、CRM应用）的Java平台，除了提供Java SE API外，还对其做了大量的扩展，并提供了相关的部署支持，这个版本以前称为J2EE。

注：目前发展最好的是Java SE和Java EE业务线，其他的目前使用很少了。

# 三：Java发展史

![image-20201215113648244](http://rocks526.top/lzx/image-20201215113648244.png)

- 1991年4月，由James Gosling博士领导的绿色计划开始启动，此计划的目的是开发一种能够在`各种消费性电子产品（如机顶盒、冰箱、收音机等）上运行的程序架构`。这个计划的产品就是Java语言的前身：Oak（橡树）。Oak当时在消费品市场上并不算成功，但随着1995年互联网潮流的兴起，Oak迅速找到了最适合自己发展的市场定位并蜕变成为Java语言。

- 1995年5月23日，Oak语言改名为Java，并且在SunWorld大会上正式发布Java 1.0版本。Java语言第一次`提出了“Write Once，Run Anywhere”的口号。`
- 1996年1月23日，JDK 1.0发布，Java语言有了第一个正式版本的运行环境。JDK 1.0提供了一个`纯解释执行的Java虚拟机实现（Sun Classic VM）`。JDK1.0版本的代表技术包括：Java虚拟机、Applet、AWT等。
- 1996年4月，10个最主要的操作系统供应商申明将在其产品中嵌入Java技术。
- 1997年2月19日，Sun公司发布了JDK 1.1，技术代表有：`JAR文件格式、JDBC、JavaBeans、RMI`。Java语法也有了一定的发展，如`内部类（Inner Class）和反射（Reflection）`都是在这个时候出现的。

- 1998年12月4日，JDK迎来了一个里程碑式的版本JDK 1.2，Sun在这个版本中把Java技术体系拆分为3个方向，分别是`面向桌面应用开发的J2SE`、`面向企业级开发的J2EE`和`面向手机等移动终端开发的J2ME`。在这个版本中出现的代表性技术非常多，如EJB、Java Plugin、Java IDL、Swing等，并且这个版本中`Java虚拟机第一次内置了JIT（Just In Time）编译器`。在语言和API级别上，Java添加了strictfp关键字与现在Java编码之中极为常用的一系列Collections集合类。
- 1999年4月27日，`HotSpot虚拟机发布。`
- 2000年5月8日JDK 1.3发布，JDK 1.3相对于JDK 1.2的改进主要表现在一些类库上（`如数学运算和新的Timer API等`），JNDI服务从JDK 1.3开始被作为一项平台级服务提供（以前JNDI仅仅是一项扩展）

- 2002年2月13日，JDK 1.4发布，JDK 1.4同样发布了很多新的技术特性，如`正则表达式、异常链、NIO、日志类、XML解析器和XSLT转换器`等。
- 2004年9月30日，JDK 1.5发布，从JDK 1.2以来，Java在语法层面上的变换一直很小，而JDK 1.5在Java语法易用性上做出了非常大的改进。例如，`自动装箱、泛型、动态注解、枚举、可变长参数、遍历循环（foreach循环）`等语法特性都是在JDK 1.5中加入的。在虚拟机和API层面上，这个版本改进了`Java的内存模型（Java Memory Model，JMM）、提供了java.util.concurrent并发包等。`
- 2006年12月11日，JDK 1.6发布，JDK 1.6的改进包括：`提供动态语言支持`（通过内置Mozilla JavaScript Rhino引擎实现）、提供编译API和微型HTTP服务器API等。同时，这个版本对Java虚拟机内部做了大量改进，包括`锁与同步、垃圾收集、类加载`等方面的算法都有相当多的改动。
- 在2006年11月13日的JavaOne大会上，`Sun公司宣布最终会将Java开源`，并在随后的一年多时间内，陆续将JDK的各个部分在GPL v2（GNU GeneralPublic License v2）协议下公开了源码，并`建立了OpenJDK组织对这些源码进行独立管理`。
- 2009年2月19日，JDK1.7发布，JDK1.7的主要改进包括：`提供新的G1收集器（G1在发布时依然处于Experimental状态，直至2012年4月的Update 4中才正式“转正”）`、`加强对非Java语言的调用支持`（JSR-292，这项特性到目前为止依然没有完全实现定型）、`升级类加载架构`等。

- 2009年4月20日，Oracle公司宣布正式以74亿美元的价格收购Sun公司，Java商标从此正式归Oracle所有

# 四：Java虚拟机发展史

- 1996年1月23日，Sun公司发布JDK 1.0，Java语言首次拥有了商用的正式运行环境，这个JDK中所带的虚拟机就是`Classic VM`。这款虚拟机只能使用`纯解释器方式`来执行Java代码，`如果要使用JIT编译器，就必须进行外挂`。但是假如`外挂了JIT编译器，JIT编译器就完全接管了虚拟机的执行系统，解释器便不再工作了`。

> 由于解释器和编译器不能配合工作，这就意味着如果要使用编译器执行，编译器就不得不对每一个方法、每一行代码都进行编译，而无论它们执行的频率是否具有编译的价值。基于程序响应时间的压力，这些编译器根本不敢应用编译耗时稍高的优化技术，因此这个阶段的虚拟机即使用了JIT编译器输出本地代码，执行效率也和传统的C/C++程序有很大差距。

- `HotSpot VM`是Sun JDK和OpenJDK中所带的虚拟机，也是目前使用范围最广的Java虚拟机。`支持热点探测，编译器和解释器混合工作等`。

> HotSpot VM的热点代码探测能力可以通过执行计数器找出最具有编译价值的代码，然后通知JIT编译器以方法为单位进行编译。如果一个方法被频繁调用，或方法中有效循环次数很多，将会分别触发标准编译和OSR（栈上替换）编译动作。通过编译器与解释器恰当地协同工作，可以在最优化的程序响应时间与最佳执行性能中取得平衡，而且无须等待本地代码输出才能执行程序，即时编译的时间压力也相对减小，这样有助于引入更多的代码优化技术，输出质量更高的本地代码。

- `JRockit VM`曾经号称“世界上速度最快的Java虚拟机”，BEA公司将其发展为一款专门为服务器硬件和服务器端应用场景高度优化的虚拟机，由于专注于服务器端应用，它可以不太关注程序启动速度，因此JRockit内部不包含解析器实现，全部代码都靠即时编译器编译后执行。
- `IBM J9`的市场定位与Sun HotSpot比较接近，它是一款设计上从服务器端到桌面应用再到嵌入式都全面考虑的多用途虚拟机，J9的开发目的是作为IBM公司各种Java产品的执行平台，它的主要市场是和IBM产品（如IBMWebSphere等）搭配以及在IBM AIX和z/OS这些平台上部署Java应用。
- KVM中的K是“Kilobyte”的意思，它强调`简单、轻量、高度可移植`，但是运行速度比较慢。在Android、iOS等智能手机操作系统出现前曾经在手机平台上得到非常广泛的应用。
- CDC/CLDC全称是Connected（Limited）Device Configuration，在JSR-139/JSR-218规范中进行定义，它希望在手机、电子书、PDA等设备上建立统一的Java编程接口，而CDC-HI VM和CLDC-HI VM则是它们的一组参考实现。
- Squawk VM由Sun公司开发，运行于Sun SPOT（Sun SmallProgrammable Object Technology，一种手持的WiFi设备），也曾经运用于Java Card。这是一个`Java代码比重很高的嵌入式虚拟机实现，其中诸如类加载器、字节码验证器、垃圾收集器、解释器、编译器和线程调度都是Java语言本身完成的`，仅仅靠C语言来编写设备I/O和必要的本地代码。
- JavaInJava是Sun公司于1997年～1998年间研发的一个实验室性质的虚拟机，从名字就可以看出，它试图以Java语言来实现Java语言本身的运行环境，既所谓的“元循环”（Meta-Circular，是指使用语言自身来实现其运行环境）。`它必须运行在另外一个宿主虚拟机之上，内部没有JIT编译器，代码只能以解释模式执行。`
- Maxine VM和上面的JavaInJava非常相似，它也是一个几乎全部以Java代码实现（只有用于启动JVM的加载器使用C语言编写）的元循环Java虚拟机。
- `Dalvik VM`是Android平台的核心组成部分之一，它的名字来源于冰岛一个名为Dalvik的小渔村。Dalvik VM并不是一个Java虚拟机，它`没有遵循Java虚拟机规范`，不能直接执行Java的Class文件，使用的是寄存器架构而不是JVM中常见的栈架构。但是它与Java又有着千丝万缕的联系，它执行的`dex（DalvikExecutable）文件可以通过Class文件转化而来`，使用Java语法编写应用程序，可以直接使用大部分的Java API等。目前Dalvik VM随着Android一起处于迅猛发展阶段，在Android 2.2中已提供即时编译器实现，在执行性能上有了很大的提高。

# 五：Java发展方向

- 模块化

`模块化是解决应用系统与技术平台越来越复杂、越来越庞大问题的一个重要途径。`无论是开发人员还是产品最终用户，都不希望为了系统中一小块的功能而不得不下载、安装、部署及维护整套庞大的系统。站在整个软件工业化的高度来看，模块化是建立各种功能的标准件的前提。最近几年`OSGi技术`的迅速发展、各个厂商在JCP中对模块化规范的激烈斗争。

- 混合语言

当单一的Java开发已经无法满足当前软件的复杂需求时，越来越多基于Java虚拟机的语言开发被应用到软件项目中，Java平台上的多语言混合编程正成为主流，每种语言都可以针对自己擅长的方面更好地解决问题。

- 多核并行

如今，CPU硬件的发展方向已经从高频率转变为多核心，随着多核时代的来临，软件开发越来越关注并行编程的领域。早在JDK 1.5就已经引入java.util.concurrent包实现了一个粗粒度的并发框架。而JDK 1.7中加入的java.util.concurrent.forkjoin包则是对这个框架的一次重要扩充。Fork/Join模式是处理并行编程的一个经典方法，能够轻松地利用多个CPU核心提供的计算资源来协作完成一个复杂的计算任务。

- 进一步丰富语法

Java 5曾经对Java语法进行了一次扩充，这次扩充加入了`自动装箱、泛型、动态注解、枚举、可变长参数、遍历循环等语法`，使得Java语言的精确性和易用性有了很大的进步。

- 64位虚拟机

在几年之前，主流的CPU就开始支持64位架构了。Java虚拟机也在很早之前就推出了支持64位系统的版本。但Java程序运行在64位虚拟机上需要付出比较大的额外代价：`占用更多的内存和CPU消耗`。